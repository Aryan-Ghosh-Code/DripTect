#include "DHT.h"

// ------------------ Pin Definitions ------------------
#define TRIG_PIN 23      // Ultrasonic Trigger
#define ECHO_PIN 22       // Ultrasonic Echo
#define RAIN_SENSOR 34    // Rain Sensor (Analog)
#define SOIL_SENSOR 35    // Soil Moisture Sensor (Analog)
#define DHTPIN 25         // DHT11 Signal Pin
#define DHTTYPE DHT11     // DHT Sensor Type

// ------------------ DHT Object ------------------
DHT dht(DHTPIN, DHTTYPE);

void setup() {
  Serial.begin(115200);

  // Ultrasonic
  pinMode(TRIG_PIN, OUTPUT);
  pinMode(ECHO_PIN, INPUT);

  // DHT
  dht.begin();
}

void loop() {
  // ------------------ Ultrasonic Sensor ------------------
  digitalWrite(TRIG_PIN, LOW);
  delayMicroseconds(2);
  digitalWrite(TRIG_PIN, HIGH);
  delayMicroseconds(10);
  digitalWrite(TRIG_PIN, LOW);

  long duration = pulseIn(ECHO_PIN, HIGH);
  float distance = duration * 0.034 / 2;

  Serial.print("Distance: ");
  Serial.print(distance);
  Serial.println(" cm");

  // ------------------ Rain Sensor ------------------
  float rainValue = analogRead(RAIN_SENSOR);
  Serial.print("Rain Sensor Value: ");
  Serial.println(rainValue/10.0);

  // ------------------ Soil Moisture ------------------
  int soilValue = analogRead(SOIL_SENSOR);
  Serial.print("Soil Moisture: ");
  Serial.println(soilValue);

  // ------------------ DHT11 ------------------
  float h = dht.readHumidity();
  float t = dht.readTemperature();

  if (isnan(h) || isnan(t)) {
    Serial.println("Failed to read from DHT sensor!");
  } else {
    Serial.print("Humidity: ");
    Serial.print(h);
    Serial.print("%  Temperature: ");
    Serial.print(t);
    Serial.println(" Â°C");
  }

  Serial.println("---------------------------");  // separator for clarity
  delay(2000);  // Wait before next cycle
}